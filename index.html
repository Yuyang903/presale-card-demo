<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>预售卡项目 - 原型设计演示</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="toggleCardType('product')">

    <!-- 顶部导航 -->
    <div class="top-nav">
        <div class="nav-logo">享乐派预售卡系统</div>
        <div class="nav-items">
            <div class="nav-item active" onclick="switchView('admin', event)">管理后台演示</div>
            <div class="nav-item" onclick="switchView('client', event)">用户端H5演示</div>
            <a href="BRD_预售卡项目.html" target="_blank" class="nav-item" style="text-decoration: none; color: inherit;">BRD文档</a>
            <a href="PRD_预售卡项目.html" target="_blank" class="nav-item" style="text-decoration: none; color: inherit;">PRD文档</a>
        </div>

    <!-- 弹窗组件：关联商品 (通用) -->
    <div id="linkProductModal" class="modal-overlay" onclick="closeModal('linkProductModal', event)">
        <div class="modal">
            <div class="modal-header">
                <span id="link-product-modal-title">关联商品</span>
                <span style="cursor:pointer;" onclick="closeModal('linkProductModal')">×</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="link-product-btn-id">
                <div style="background:#fff3cd; color:#856404; padding:10px; font-size:12px; border-radius:4px; margin-bottom:15px;">
                    提示：必须关联至少一个商品供用户兑换后才能激活。
                </div>
                <div class="form-group">
                    <label id="link-product-label">可选商品池</label>
                    <div style="border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: #f9f9f9;">
                        <!-- 复用已有的商品列表样式 -->
                        <div id="link-selected-products" style="margin-bottom: 10px;"></div>
                        
                        <div style="display: flex; gap: 5px;">
                            <select id="link-product-select" class="form-control" style="flex: 1;">
                                <option value="">请选择商品添加...</option>
                                <option value="豪华月饼礼盒 (ID: 1001)">豪华月饼礼盒 (ID: 1001)</option>
                                <option value="坚果大礼包 (ID: 1002)">坚果大礼包 (ID: 1002)</option>
                                <option value="海鲜大礼包 (ID: 1003)">海鲜大礼包 (ID: 1003)</option>
                                <option value="经典黑胶唱片 (ID: 2001)">经典黑胶唱片 (ID: 2001)</option>
                                <option value="无线蓝牙耳机 (ID: 2002)">无线蓝牙耳机 (ID: 2002)</option>
                                <option value="智能保温杯 (ID: 2003)">智能保温杯 (ID: 2003)</option>
                            </select>
                            <button class="btn btn-primary btn-sm" style="width: auto;" onclick="addLinkProduct()">添加</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('linkProductModal')">取消</button>
                <button class="btn btn-primary" onclick="saveLinkProducts()">保存关联</button>
            </div>
        </div>
    </div>
    </div>

    <div class="container">
        
        <!-- 视图1：管理后台 -->
        <div id="admin-view" class="view-section active">
            <div class="admin-layout">
                <div class="admin-sidebar">
                    <div class="admin-menu-item active" onclick="switchAdminTab('card', event)">卡片管理</div>
                    <div class="admin-menu-item" onclick="switchAdminTab('distributor', event)">分发商管理</div>
                    <div class="admin-menu-item" onclick="switchAdminTab('order', event)">订单管理</div>
                    <div class="admin-menu-item" onclick="switchAdminTab('finance', event)">财务管理</div>
                    <div class="admin-menu-item" onclick="switchAdminTab('settlement', event)">结算管理</div>
                </div>
                
                <div class="admin-content">
                    
                    <!-- 卡片管理模块 -->
                    <div id="tab-card" class="admin-module">
                        
                        <!-- 卡片列表视图 -->
                        <div id="card-list-view">
                            <div class="admin-header-bar">
                                <div class="admin-title">卡片管理</div>
                                <div>
                                    <button class="btn btn-success" onclick="openModal('createCardModal')">+ 新增制卡</button>
                                    <button class="btn btn-warning" onclick="alert('功能仅演示')">批量激活</button>
                                    <button class="btn btn-outline" onclick="alert('功能仅演示')">导出数据</button>
                                </div>
                            </div>

                            <!-- 流程指引 -->
                            <div style="margin-bottom: 15px; padding: 10px; background: #f0f7ff; border: 1px solid #cce5ff; border-radius: 4px; font-size: 12px; color: #004085; display: flex; align-items: center; flex-wrap: wrap; gap: 5px;">
                                <strong>业务流程：</strong>
                                <span style="background:#fff; padding:2px 6px; border-radius:3px; border:1px solid #b8daff;">1. 制卡 (未激活)</span>
                                <span style="color:#666;">→</span>
                                <span style="background:#fff; padding:2px 6px; border-radius:3px; border:1px solid #b8daff;">2. 关联商品</span>
                                <span style="color:#666;">→</span>
                                <span style="background:#fff; padding:2px 6px; border-radius:3px; border:1px solid #b8daff;">3. 导出数据 & 生产</span>
                                <span style="color:#666;">→</span>
                                <span style="background:#fff; padding:2px 6px; border-radius:3px; border:1px solid #b8daff;">4. 激活批次</span>
                                <span style="color:#666;">→</span>
                                <span style="background:#fff; padding:2px 6px; border-radius:3px; border:1px solid #b8daff;">5. 分发</span>
                                <span style="color:#666;">→</span>
                                <span style="background:#fff; padding:2px 6px; border-radius:3px; border:1px solid #b8daff;">6. 用户兑换</span>
                            </div>

                            <div class="filter-bar">
                                <input type="text" class="form-control" placeholder="批次名称" style="width: 200px;">
                                <input type="text" class="form-control" placeholder="商品名称" style="width: 200px;">
                                <select class="form-control">
                                    <option>所有状态</option>
                                    <option>未激活</option>
                                    <option>已激活</option>
                                    <option>已作废</option>
                                </select>
                                <button class="btn btn-primary" onclick="alert('功能仅演示')">查询</button>
                            </div>

                            <div class="admin-card">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th width="40"><input type="checkbox"></th>
                                            <th>批次名称</th>
                                            <th>类型</th>
                                            <th>分发商</th>
                                            <th>内容/面额</th>
                                            <th>卡片总数</th>
                                            <th>激活未使用/已使用/作废</th>
                                            <th width="180">时间信息</th>
                                            <th>状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr data-total="200" data-remark="未激活测试批次">
                                            <td><input type="checkbox"></td>
                                            <td>中秋礼品卡_批次A</td>
                                            <td><span class="tag p2">商品卡</span></td>
                                            <td>直营</td>
                                            <td>豪华月饼礼盒</td>
                                            <td>500</td>
                                            <td>330 / 120 / 5</td>
                                            <td style="font-size:12px; line-height:1.4;">
                                                <div style="color:#999;">生成：2023-10-01</div>
                                                <div style="color:#27ae60;">发货：2023-10-05</div>
                                            </td>
                                            <td><span class="tag p1">已激活</span></td>
                                            <td>
                                                <button class="btn btn-primary btn-sm" onclick="openEditBatchModal(this)">修改</button>
                                                <button class="btn btn-info btn-sm" onclick="openBatchDetailModal(this)">详情</button>
                                                <button class="btn btn-secondary btn-sm" onclick="showCardList(this)">卡片</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><input type="checkbox"></td>
                                            <td>企业积分卡_批次C</td>
                                            <td><span class="tag" style="background:#9b59b6;">积分卡</span></td>
                                            <td>分发商A (7折)</td>
                                            <td>300 积分</td>
                                            <td>1000</td>
                                            <td>800 / 200 / 0</td>
                                            <td style="font-size:12px; line-height:1.4;">
                                                <div style="color:#999;">生成：2023-11-01</div>
                                                <div style="color:#27ae60;">发货：2023-11-05</div>
                                            </td>
                                            <td><span class="tag p1">已激活</span></td>
                                            <td>
                                                <button class="btn btn-primary btn-sm" onclick="openEditBatchModal(this)">修改</button>
                                                <button class="btn btn-info btn-sm" onclick="openBatchDetailModal(this)">详情</button>
                                                <button class="btn btn-warning btn-sm" onclick="openLinkProductModal(this)">关联商品</button>
                                                <button class="btn btn-secondary btn-sm" onclick="showCardList(this)">卡片</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td><input type="checkbox"></td>
                                            <td>国庆福利卡_批次B</td>
                                            <td><span class="tag p2">商品卡</span></td>
                                            <td>直营</td>
                                            <td>坚果大礼包</td>
                                            <td>200</td>
                                            <td>0 / 0 / 0</td>
                                            <td style="font-size:12px; line-height:1.4;">
                                                <div style="color:#999;">生成：2023-10-05</div>
                                                <div style="color:#27ae60;">发货：2023-10-15</div>
                                            </td>
                                            <td><span class="tag gray">未激活</span></td>
                                            <td>
                                                <button class="btn btn-success btn-sm" onclick="activateBatch(this)">激活</button>
                                                <button class="btn btn-primary btn-sm" onclick="openEditBatchModal(this)">修改</button>
                                                <button class="btn btn-info btn-sm" onclick="openBatchDetailModal(this)">详情</button>
                                                <button class="btn btn-secondary btn-sm" onclick="showCardList(this)">卡片</button>
                                                <button class="btn btn-danger btn-sm" onclick="voidBatch(this)">作废</button>
                                            </td>
                                        </tr>
                                        <tr data-total="1000" data-remark="操作失误作废">
                                            <td><input type="checkbox"></td>
                                            <td>春节预售卡_批次C</td>
                                            <td>海鲜大礼包</td>
                                            <td>1000</td>
                                            <td>0 / 0 / 1000</td>
                                            <td style="font-size:12px; line-height:1.4;">
                                                <div style="color:#999;">生成：2023-09-20 09:00</div>
                                                <div>开始：2023-09-20 00:00</div>
                                                <div style="color:#27ae60;">预计发货：2023-09-25</div>
                                            </td>
                                            <td><span class="tag p0">已作废</span></td>
                                            <td>
                                                <button class="btn btn-info btn-sm" onclick="openBatchDetailModal(this)">批次详情</button>
                                                <button class="btn btn-secondary btn-sm" onclick="showCardList(this)">卡片</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                        
                        <!-- 批次详情视图 (默认隐藏) -->
                        <div id="card-detail-view" style="display:none;">
                            <div class="admin-header-bar">
                                <div style="display:flex; align-items:center; gap:10px;">
                                    <button class="btn btn-outline" onclick="hideBatchDetail()">← 返回</button>
                                    <div class="admin-title" id="detail-batch-name">批次详情：中秋礼品卡_批次A</div>
                                </div>
                                <div>
                                    <button class="btn btn-primary" onclick="alert('功能仅演示')">导出卡密</button>
                                    <button class="btn btn-success" onclick="alert('功能仅演示')">激活本批次</button>
                                    <button class="btn btn-danger" onclick="alert('功能仅演示')">作废本批次</button>
                                </div>
                            </div>

                            <!-- 概览数据卡片 -->
                            <div style="display:flex; gap:20px; margin-bottom:20px;">
                                <div class="admin-card" style="flex:1; margin-bottom:0; text-align:center; padding:15px;">
                                    <div style="color:#666; font-size:14px;">总卡量</div>
                                    <div style="font-size:24px; font-weight:bold; color:var(--primary-color);" id="detail-total-count">500</div>
                                </div>
                                <div class="admin-card" style="flex:1; margin-bottom:0; text-align:center; padding:15px;">
                                    <div style="color:#666; font-size:14px;">已激活</div>
                                    <div style="font-size:24px; font-weight:bold; color:var(--success-color);" id="detail-activated-count">450</div>
                                </div>
                                <div class="admin-card" style="flex:1; margin-bottom:0; text-align:center; padding:15px;">
                                    <div style="color:#666; font-size:14px;">已使用</div>
                                    <div style="font-size:24px; font-weight:bold; color:var(--warning-color);" id="detail-used-count">120</div>
                                </div>
                                <div class="admin-card" style="flex:1; margin-bottom:0; text-align:center; padding:15px;">
                                    <div style="color:#666; font-size:14px;">已作废</div>
                                    <div style="font-size:24px; font-weight:bold; color:var(--danger-color);" id="detail-void-count">5</div>
                                </div>
                            </div>

                            <div class="admin-card">
                                <div style="margin-bottom:15px; font-weight:bold; border-bottom:1px solid #eee; padding-bottom:10px;">本批次卡片列表</div>
                                <div class="filter-bar" style="margin-bottom:15px; padding:10px;">
                                    <input type="text" class="form-control" placeholder="搜索卡号" style="width: 200px;">
                                    <select class="form-control">
                                        <option>状态筛选</option>
                                        <option>未激活</option>
                                        <option>已激活</option>
                                        <option>已使用</option>
                                    </select>
                                    <button class="btn btn-primary btn-sm">搜索</button>
                                    <button class="btn btn-outline btn-sm">导出Excel</button>
                                </div>
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>卡号</th>
                                            <th>兑换链接</th>
                                            <th>状态</th>
                                            <th>生成时间</th>
                                            <th>兑换时间</th>
                                            <th>订单号</th>
                                            <th>商品</th>
                                            <th>发货状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>VIP-20231027-001</td>
                                            <td><a href="#" style="color:#3498db; text-decoration:none;">https://xle.com/c/x8s7...</a></td>
                                            <td><span class="tag p1">已激活</span></td>
                                            <td>2023-10-01 10:00</td>
                                            <td>-</td>
                                            <td><span style="color:#999;">未使用</span></td>
                                            <td>豪华月饼礼盒</td>
                                            <td><span style="color:#999;">未使用</span></td>
                                            <td><button class="btn btn-danger btn-sm">作废</button></td>
                                        </tr>
                                        <tr>
                                            <td>VIP-20231027-002</td>
                                            <td><a href="#" style="color:#3498db; text-decoration:none;">https://xle.com/c/k92a...</a></td>
                                            <td><span class="tag p2">已使用</span></td>
                                            <td>2023-10-01 10:00</td>
                                            <td>2023-10-15 14:30</td>
                                            <td>ORD-20231015-001</td>
                                            <td>豪华月饼礼盒</td>
                                            <td><span class="tag p2">已发货</span></td>
                                            <td><button class="btn btn-secondary btn-sm" onclick="openModal('orderDetailModal')">订单详情</button></td>
                                        </tr>
                                        <tr>
                                            <td>VIP-20231027-004</td>
                                            <td><a href="#" style="color:#3498db; text-decoration:none;">https://xle.com/c/m3d9...</a></td>
                                            <td><span class="tag gray">未激活</span></td>
                                            <td>2023-10-01 10:00</td>
                                            <td>-</td>
                                            <td><span style="color:#999;">未使用</span></td>
                                            <td>豪华月饼礼盒</td>
                                            <td><span style="color:#999;">未使用</span></td>
                                            <td><button class="btn btn-success btn-sm">激活</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>

                    <!-- 分发商管理模块 -->
                    <div id="tab-distributor" class="admin-module" style="display:none;">
                        <div class="admin-header-bar">
                            <div class="admin-title">分发商管理</div>
                            <button class="btn btn-success" onclick="openModal('editDistributorModal'); resetDistributorForm();">+ 新增分发商</button>
                        </div>
                        
                        <div class="admin-card">
                            <table class="admin-table" id="distributor-table">
                                <thead>
                                    <tr>
                                        <th>分发商名称</th>
                                        <th>联系人</th>
                                        <th>联系电话</th>
                                        <th>合作状态</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr data-id="d1">
                                        <td>分发商A</td>
                                        <td>王经理</td>
                                        <td>13812345678</td>
                                        <td><span class="tag p1">合作中</span></td>
                                        <td>
                                            <button class="btn btn-primary btn-sm" onclick="editDistributor(this)">编辑</button>
                                            <button class="btn btn-danger btn-sm" onclick="toggleDistributorStatus(this)">停用</button>
                                        </td>
                                    </tr>
                                    <tr data-id="d2">
                                        <td>分发商B</td>
                                        <td>李总</td>
                                        <td>13987654321</td>
                                        <td><span class="tag p1">合作中</span></td>
                                        <td>
                                            <button class="btn btn-primary btn-sm" onclick="editDistributor(this)">编辑</button>
                                            <button class="btn btn-danger btn-sm" onclick="toggleDistributorStatus(this)">停用</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 订单管理模块 -->
                    <div id="tab-order" class="admin-module" style="display:none;">
                        <div class="admin-header-bar">
                            <div class="admin-title">订单管理</div>
                            <button class="btn btn-outline" onclick="alert('功能仅演示')">批量导出发货单</button>
                        </div>
                        
                        <!-- 订单类型Tab -->
                        <div style="display:flex; gap:30px; border-bottom:1px solid #eee; padding-bottom:15px; margin-bottom:15px;">
                            <div id="ot-presale" class="order-tab active" onclick="switchOrderTab('presale')" style="font-weight:bold; color:var(--primary-color); border-bottom:2px solid var(--primary-color); padding-bottom:5px; cursor:pointer;">预售卡兑换订单</div>
                            <div id="ot-gift" class="order-tab" onclick="switchOrderTab('gift')" style="color:#666; cursor:pointer; padding-bottom:5px;">礼品卡商城订单</div>
                        </div>

                        <!-- 1. 预售卡订单视图 -->
                        <div id="order-presale-view">
                            <div class="filter-bar" style="flex-wrap: wrap; gap: 10px;">
                                <input type="text" class="form-control" placeholder="订单号" style="width: 150px;">
                                <input type="text" class="form-control" placeholder="卡批次" style="width: 150px;">
                                <input type="text" class="form-control" placeholder="商品名称" style="width: 150px;">
                                <input type="text" class="form-control" placeholder="收货人" style="width: 120px;">
                                <input type="text" class="form-control" placeholder="手机号" style="width: 120px;">
                                <select class="form-control" style="width: 120px;">
                                    <option>所有状态</option>
                                    <option>待发货</option>
                                    <option>已发货</option>
                                </select>
                                <button class="btn btn-primary" onclick="alert('功能仅演示')">查询</button>
                            </div>

                            <div class="admin-card">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>订单号</th>
                                            <th>关联卡号</th>
                                            <th>商品信息</th>
                                            <th>收货人</th>
                                            <th>物流状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>ORD-20231027-001</td>
                                            <td>VIP-002</td>
                                            <td>豪华月饼礼盒 x1</td>
                                            <td>张三 (13800000000)<br><span style="color:#999;font-size:12px;">北京市朝阳区...</span></td>
                                            <td><span class="tag p1">待发货</span></td>
                                            <td><button class="btn btn-secondary" onclick="openModal('orderDetailModal')">详情</button></td>
                                        </tr>
                                        <tr>
                                            <td>ORD-20231026-055</td>
                                            <td>VIP-099</td>
                                            <td>坚果大礼包 x1</td>
                                            <td>李四 (13900000000)<br><span style="color:#999;font-size:12px;">上海市浦东新区...</span></td>
                                            <td><span class="tag p2">已发货</span></td>
                                            <td><button class="btn btn-secondary" onclick="openModal('orderDetailModal')">详情</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- 2. 礼品卡订单视图 -->
                        <div id="order-gift-view" style="display:none;">
                            <div class="filter-bar" style="flex-wrap: wrap; gap: 10px;">
                                <input type="text" class="form-control" placeholder="订单号" style="width: 150px;">
                                <input type="text" class="form-control" placeholder="支付卡号" style="width: 150px;">
                                <input type="text" class="form-control" placeholder="收货人" style="width: 120px;">
                                <select class="form-control" style="width: 120px;">
                                    <option>所有状态</option>
                                    <option>待发货</option>
                                    <option>已发货</option>
                                </select>
                                <button class="btn btn-primary" onclick="alert('功能仅演示')">查询</button>
                            </div>

                            <div class="admin-card">
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>订单号</th>
                                            <th>支付卡号</th>
                                            <th>消耗积分</th>
                                            <th>商品明细</th>
                                            <th>收货人</th>
                                            <th>物流状态</th>
                                            <th>操作</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>MALL-20231115-008</td>
                                            <td>GIFT-888</td>
                                            <td style="color:var(--warning-color); font-weight:bold;">300</td>
                                            <td>
                                                <div>经典黑胶唱片 x1</div>
                                            </td>
                                            <td>王五 (13766668888)</td>
                                            <td><span class="tag p1">待发货</span></td>
                                            <td><button class="btn btn-secondary" onclick="openModal('orderDetailModal')">详情</button></td>
                                        </tr>
                                        <tr>
                                            <td>MALL-20231112-023</td>
                                            <td>GIFT-999</td>
                                            <td style="color:var(--warning-color); font-weight:bold;">150</td>
                                            <td>
                                                <div>智能保温杯 x1</div>
                                            </td>
                                            <td>赵六 (13612341234)</td>
                                            <td><span class="tag p2">已发货</span></td>
                                            <td><button class="btn btn-secondary" onclick="openModal('orderDetailModal')">详情</button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                    </div>

                    <!-- 财务管理模块 -->
                    <div id="tab-finance" class="admin-module" style="display:none;">
                        <div class="admin-header-bar">
                            <div class="admin-title">财务管理</div>
                        </div>
                        
                        <div class="admin-card" style="margin-bottom: 20px;">
                            <!-- 财务子Tab -->
                            <div style="display:flex; gap:30px; border-bottom:1px solid #eee; padding-bottom:15px; margin-bottom:15px;">
                                <div id="ft-income" class="finance-tab active" onclick="switchFinanceTab('income')" style="font-weight:bold; color:var(--primary-color); border-bottom:2px solid var(--primary-color); padding-bottom:5px; cursor:pointer;">收款记录</div>
                                <div id="ft-cost" class="finance-tab" onclick="switchFinanceTab('cost')" style="color:#666; cursor:pointer; padding-bottom:5px;">制卡成本</div>
                                <div id="ft-overview" class="finance-tab" onclick="switchFinanceTab('overview')" style="color:#666; cursor:pointer; padding-bottom:5px;">收支概览</div>
                            </div>
                            
                            <!-- 1. 收款记录视图 -->
                            <div id="finance-income-view">
                                <div style="margin-bottom:15px; text-align:right;">
                                    <button class="btn btn-success" onclick="alert('功能仅演示')">+ 新增收款</button>
                                </div>
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>收款日期</th>
                                            <th>客户名称</th>
                                            <th>购买内容</th>
                                            <th>实收金额</th>
                                            <th>支付方式</th>
                                            <th>经手人</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2023-10-25</td>
                                            <td>某某科技公司</td>
                                            <td>中秋礼品卡 x 50张</td>
                                            <td style="font-weight:bold; color:var(--danger-color);">¥ 15,000.00</td>
                                            <td>对公转账</td>
                                            <td>王经理</td>
                                        </tr>
                                        <tr>
                                            <td>2023-10-26</td>
                                            <td>李先生</td>
                                            <td>中秋礼品卡 x 2张</td>
                                            <td style="font-weight:bold; color:var(--danger-color);">¥ 600.00</td>
                                            <td>微信支付</td>
                                            <td>前台小张</td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr style="background:#f9f9f9; font-weight:bold;">
                                            <td colspan="3" style="text-align:right;">合计：</td>
                                            <td colspan="3" style="color:var(--danger-color);">¥ 15,600.00</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>

                            <!-- 2. 制卡成本视图 -->
                            <div id="finance-cost-view" style="display:none;">
                                <div style="margin-bottom:15px; text-align:right;">
                                    <button class="btn btn-warning" onclick="alert('功能仅演示')">+ 登记成本</button>
                                </div>
                                <table class="admin-table">
                                    <thead>
                                        <tr>
                                            <th>登记日期</th>
                                            <th>批次名称</th>
                                            <th>供应商</th>
                                            <th>制卡数量</th>
                                            <th>总成本</th>
                                            <th>单张成本</th>
                                            <th>经手人</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>2023-09-28</td>
                                            <td>中秋礼品卡_批次A</td>
                                            <td>xx印刷厂</td>
                                            <td>500</td>
                                            <td style="font-weight:bold; color:var(--primary-color);">¥ 2,500.00</td>
                                            <td>¥ 5.00</td>
                                            <td>采购部</td>
                                        </tr>
                                        <tr>
                                            <td>2023-10-02</td>
                                            <td>国庆福利卡_批次B</td>
                                            <td>xx印刷厂</td>
                                            <td>200</td>
                                            <td style="font-weight:bold; color:var(--primary-color);">¥ 1,200.00</td>
                                            <td>¥ 6.00</td>
                                            <td>采购部</td>
                                        </tr>
                                    </tbody>
                                    <tfoot>
                                        <tr style="background:#f9f9f9; font-weight:bold;">
                                            <td colspan="4" style="text-align:right;">合计支出：</td>
                                            <td colspan="3" style="color:var(--primary-color);">¥ 3,700.00</td>
                                        </tr>
                                    </tfoot>
                                </table>
                            </div>

                            <!-- 3. 收支概览视图 -->
                            <div id="finance-overview-view" style="display:none; text-align:center; padding:50px; color:#999;">
                                暂无概览数据图表
                            </div>
                        </div>
                    </div>

                    <!-- 结算管理模块 -->
                    <div id="tab-settlement" class="admin-module" style="display:none;">
                        <div class="admin-header-bar">
                            <div class="admin-title">结算管理</div>
                        </div>
                        
                        <div class="filter-bar">
                            <select class="form-control">
                                <option>所有分发商</option>
                                <option>分发商A</option>
                                <option>分发商B</option>
                            </select>
                            <input type="month" class="form-control">
                            <button class="btn btn-primary" onclick="alert('功能仅演示')">查询</button>
                            <button class="btn btn-outline" onclick="alert('功能仅演示')">导出对账单</button>
                        </div>

                        <div class="admin-card">
                            <h4 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">分发商对账单 (2023年10月)</h4>
                            <table class="admin-table">
                                <thead>
                                    <tr>
                                        <th>分发商</th>
                                        <th>发货订单数</th>
                                        <th>商品总价值</th>
                                        <th>结算折扣</th>
                                        <th>应结算金额</th>
                                        <th>结算状态</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>分发商A</td>
                                        <td>120</td>
                                        <td>¥ 36,000.00</td>
                                        <td>70%</td>
                                        <td style="font-weight:bold; color:var(--danger-color);">¥ 25,200.00</td>
                                        <td><span class="tag p0">未结算</span></td>
                                        <td>
                                            <button class="btn btn-success btn-sm">标记结算</button>
                                            <button class="btn btn-info btn-sm">明细</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>分发商B</td>
                                        <td>50</td>
                                        <td>¥ 15,000.00</td>
                                        <td>85%</td>
                                        <td style="font-weight:bold; color:var(--danger-color);">¥ 12,750.00</td>
                                        <td><span class="tag p1">已结算</span></td>
                                        <td>
                                            <button class="btn btn-secondary btn-sm" disabled>标记结算</button>
                                            <button class="btn btn-info btn-sm">明细</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                </div>
            </div>
        </div>

        <!-- 视图2：用户端H5 -->
        <div id="client-view" class="view-section">
            <div class="mobile-layout">

                <!-- 场景1：未到兑换时间 (展示页模式) -->
                <div class="phone-mockup">
                    <div class="phone-notch"></div>
                    <div class="phone-header">商品详情</div>
                    <div class="phone-content" style="padding-bottom: 60px;">
                        <!-- 主图 -->
                        <div style="width:100%; height:250px; background:#e0e0e0; display:flex; align-items:center; justify-content:center; color:#999; margin-bottom:0; position:relative;">
                            <span style="font-size: 24px;">📸 商品主图轮播</span>
                            <div style="position:absolute; bottom:10px; right:10px; background:rgba(0,0,0,0.5); color:#fff; padding:2px 8px; border-radius:10px; font-size:12px;">1/5</div>
                        </div>
                        
                        <!-- 标题区域 -->
                        <div style="background:#fff; padding:15px; margin-bottom:10px;">
                            <h3 style="margin:0 0 5px 0; font-size:16px; line-height:1.4;">【尊享版】享乐派豪华礼包 | 特级茶叶+坚果礼盒+定制保温杯</h3>
                            <div class="goods-subtitle">企业定制首选 · 限量发售 · 包含精美礼品袋</div>
                            <div style="display:flex; justify-content:space-between; color:#999; font-size:12px; margin-top: 10px;">
                                <span>运费：包邮</span>
                                <span>月销 1000+</span>
                                <span>库存 500</span>
                            </div>
                        </div>

                        <!-- 用户推荐 -->
                        <div class="user-recommend">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                                <h4 style="margin:0; font-size:14px;">用户推荐</h4>
                                <span style="font-size:12px; color:#999;">查看全部 ></span>
                            </div>
                            <div class="recommend-item">
                                <div class="avatar"></div>
                                <div>
                                    <div style="margin-bottom:3px; font-weight:bold;">王先生</div>
                                    <div style="line-height:1.4;">包装非常精美，送礼很有面子，茶叶口感也不错！</div>
                                </div>
                            </div>
                            <div class="recommend-item">
                                <div class="avatar"></div>
                                <div>
                                    <div style="margin-bottom:3px; font-weight:bold;">李女士</div>
                                    <div style="line-height:1.4;">兑换流程很顺畅，发货也快，五星好评。</div>
                                </div>
                            </div>
                        </div>

                        <!-- 详情 -->
                        <div class="m-card">
                            <h4 style="margin:0 0 10px 0; font-size:14px; border-left:3px solid var(--primary-color); padding-left:8px;">商品详情</h4>
                            <div style="font-size:13px; color:#666; line-height:1.6;">
                                <p>精选特级高山茶叶，香气浓郁，回甘悠长。</p>
                                <div style="width:100%; height:150px; background:#f0f0f0; margin:10px 0; display:flex; align-items:center; justify-content:center; color:#ccc;">详情图 1</div>
                                <p>进口坚果礼盒，营养美味，健康首选。</p>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 底部操作栏 -->
                    <div class="bottom-action-bar">
                        <div class="nav-icon-btn">
                            <span>🏠</span>
                            <span>首页</span>
                        </div>
                        <div class="nav-icon-btn">
                            <span>🎧</span>
                            <span>客服</span>
                        </div>
                        <div class="main-action-btn disabled">
                            未到兑换时间
                        </div>
                    </div>
                </div>

                <div class="step-arrow">→</div>

                <!-- 场景2：卡片已使用 (展示页模式) -->
                <div class="phone-mockup">
                    <div class="phone-notch"></div>
                    <div class="phone-header">商品详情</div>
                    <div class="phone-content" style="padding-bottom: 60px;">
                        <!-- 主图 -->
                        <div style="width:100%; height:250px; background:#e0e0e0; display:flex; align-items:center; justify-content:center; color:#999; margin-bottom:0; position:relative;">
                            <span style="font-size: 24px;">📸 商品主图轮播</span>
                        </div>
                        
                        <!-- 标题区域 -->
                        <div style="background:#fff; padding:15px; margin-bottom:10px;">
                            <h3 style="margin:0 0 5px 0; font-size:16px; line-height:1.4;">【尊享版】享乐派豪华礼包 | 特级茶叶+坚果礼盒+定制保温杯</h3>
                            <div class="goods-subtitle">企业定制首选 · 限量发售 · 包含精美礼品袋</div>
                            <div style="display:flex; justify-content:space-between; color:#999; font-size:12px; margin-top: 10px;">
                                <span>运费：包邮</span>
                                <span>月销 1000+</span>
                                <span>库存 500</span>
                            </div>
                        </div>

                        <!-- 用户推荐 -->
                        <div class="user-recommend">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                                <h4 style="margin:0; font-size:14px;">用户推荐</h4>
                                <span style="font-size:12px; color:#999;">查看全部 ></span>
                            </div>
                            <div class="recommend-item">
                                <div class="avatar"></div>
                                <div>
                                    <div style="margin-bottom:3px; font-weight:bold;">王先生</div>
                                    <div style="line-height:1.4;">包装非常精美，送礼很有面子！</div>
                                </div>
                            </div>
                        </div>

                        <!-- 详情 -->
                        <div class="m-card">
                            <h4 style="margin:0 0 10px 0; font-size:14px; border-left:3px solid var(--primary-color); padding-left:8px;">商品详情</h4>
                            <div style="font-size:13px; color:#666; line-height:1.6;">
                                <p>精选特级高山茶叶，香气浓郁，回甘悠长。</p>
                                <div style="width:100%; height:150px; background:#f0f0f0; margin:10px 0; display:flex; align-items:center; justify-content:center; color:#ccc;">详情图 1</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 底部操作栏 -->
                    <div class="bottom-action-bar">
                        <div class="nav-icon-btn">
                            <span>🏠</span>
                            <span>首页</span>
                        </div>
                        <div class="nav-icon-btn">
                            <span>🎧</span>
                            <span>客服</span>
                        </div>
                        <div class="main-action-btn disabled">
                            卡片已使用
                        </div>
                    </div>
                </div>

                <div class="step-arrow">→</div>
                
                <!-- 场景3：正常兑换 (展示页模式) -->
                <div class="phone-mockup">
                    <div class="phone-notch"></div>
                    <div class="phone-header">商品详情</div>
                    <div class="phone-content" style="padding-bottom: 60px;">
                        <!-- 主图 -->
                        <div style="width:100%; height:250px; background:#e0e0e0; display:flex; align-items:center; justify-content:center; color:#999; margin-bottom:0; position:relative;">
                            <span style="font-size: 24px;">📸 商品主图轮播</span>
                            <div style="position:absolute; bottom:10px; right:10px; background:rgba(0,0,0,0.5); color:#fff; padding:2px 8px; border-radius:10px; font-size:12px;">1/5</div>
                        </div>
                        
                        <!-- 标题区域 -->
                        <div style="background:#fff; padding:15px; margin-bottom:10px;">
                            <h3 style="margin:0 0 5px 0; font-size:16px; line-height:1.4;">【尊享版】享乐派豪华礼包 | 特级茶叶+坚果礼盒+定制保温杯</h3>
                            <div class="goods-subtitle">企业定制首选 · 限量发售 · 包含精美礼品袋</div>
                            <div style="display:flex; justify-content:space-between; color:#999; font-size:12px; margin-top: 10px;">
                                <span>运费：包邮</span>
                                <span>月销 1000+</span>
                                <span>库存 500</span>
                            </div>
                        </div>

                        <!-- 用户推荐 -->
                        <div class="user-recommend">
                            <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px;">
                                <h4 style="margin:0; font-size:14px;">用户推荐</h4>
                                <span style="font-size:12px; color:#999;">查看全部 ></span>
                            </div>
                            <div class="recommend-item">
                                <div class="avatar"></div>
                                <div>
                                    <div style="margin-bottom:3px; font-weight:bold;">王先生</div>
                                    <div style="line-height:1.4;">包装非常精美，送礼很有面子，茶叶口感也不错！</div>
                                </div>
                            </div>
                            <div class="recommend-item">
                                <div class="avatar"></div>
                                <div>
                                    <div style="margin-bottom:3px; font-weight:bold;">李女士</div>
                                    <div style="line-height:1.4;">兑换流程很顺畅，发货也快，五星好评。</div>
                                </div>
                            </div>
                        </div>

                        <div style="background:#fff; padding:15px; margin-bottom:10px;">
                            <div style="display:flex; justify-content:space-between; align-items:center; font-size:14px;">
                                <span style="color:#999;">保障</span>
                                <span>正品保证 · 极速发货 · 7天无理由</span>
                                <span style="color:#ccc;">></span>
                            </div>
                        </div>

                        <!-- 详情 -->
                        <div class="m-card">
                            <h4 style="margin:0 0 10px 0; font-size:14px; border-left:3px solid var(--primary-color); padding-left:8px;">商品详情</h4>
                            <div style="font-size:13px; color:#666; line-height:1.6;">
                                <p>精选特级高山茶叶，香气浓郁，回甘悠长。</p>
                                <div style="width:100%; height:150px; background:#f0f0f0; margin:10px 0; display:flex; align-items:center; justify-content:center; color:#ccc;">详情图 1</div>
                                <p>进口坚果礼盒，营养美味，健康首选。</p>
                                <div style="width:100%; height:150px; background:#f0f0f0; margin:10px 0; display:flex; align-items:center; justify-content:center; color:#ccc;">详情图 2</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- 底部操作栏 -->
                    <div class="bottom-action-bar">
                        <div class="nav-icon-btn">
                            <span>🏠</span>
                            <span>首页</span>
                        </div>
                        <div class="nav-icon-btn">
                            <span>🎧</span>
                            <span>客服</span>
                        </div>
                        <div class="main-action-btn active">
                            立即兑换
                        </div>
                    </div>
                </div>

                <div class="step-arrow">→</div>

                <!-- 场景4：积分兑换 (积分卡模式) -->
                <div class="phone-mockup">
                    <div class="phone-notch"></div>
                    <div class="phone-header">积分商城</div>
                    <div class="phone-content" style="padding-bottom: 60px;">
                        
                        <!-- 积分信息卡 -->
                        <div style="background: linear-gradient(135deg, #3498db, #8e44ad); color: #fff; padding: 20px; border-radius: 8px; margin-bottom: 15px; box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);">
                            <div style="font-size: 12px; opacity: 0.8;">当前可用积分</div>
                            <div style="font-size: 32px; font-weight: bold; margin: 5px 0;">300 <span style="font-size: 14px; font-weight: normal;">分</span></div>
                            <div style="font-size: 12px; opacity: 0.8;">有效期至：2026-12-31</div>
                        </div>
                        
                        <!-- 筛选栏 -->
                        <div style="display: flex; gap: 10px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 5px;">
                            <span style="background: var(--primary-color); color: #fff; padding: 4px 12px; border-radius: 15px; font-size: 12px; flex-shrink: 0;">全部商品</span>
                            <span style="background: #fff; color: #666; padding: 4px 12px; border-radius: 15px; font-size: 12px; flex-shrink: 0;">数码家电</span>
                            <span style="background: #fff; color: #666; padding: 4px 12px; border-radius: 15px; font-size: 12px; flex-shrink: 0;">家居生活</span>
                            <span style="background: #fff; color: #666; padding: 4px 12px; border-radius: 15px; font-size: 12px; flex-shrink: 0;">食品饮料</span>
                        </div>

                        <!-- 商品列表 -->
                        <div style="display: flex; flex-wrap: wrap; gap: 10px;">
                            <!-- 商品1 -->
                            <div style="width: calc(50% - 5px); background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                <div style="height: 120px; background: #e0e0e0; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">唱片封面</div>
                                <div style="padding: 10px;">
                                    <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; height: 36px; overflow: hidden;">经典黑胶唱片 - 珍藏版</div>
                                    <div style="color: var(--warning-color); font-weight: bold; font-size: 14px;">300 积分</div>
                                    <button class="m-btn" style="padding: 5px; margin-top: 5px; font-size: 12px;">立即兑换</button>
                                </div>
                            </div>
                            
                            <!-- 商品2 -->
                            <div style="width: calc(50% - 5px); background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                <div style="height: 120px; background: #e0e0e0; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">耳机图</div>
                                <div style="padding: 10px;">
                                    <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; height: 36px; overflow: hidden;">无线蓝牙耳机</div>
                                    <div style="color: var(--warning-color); font-weight: bold; font-size: 14px;">280 积分</div>
                                    <button class="m-btn" style="padding: 5px; margin-top: 5px; font-size: 12px;">立即兑换</button>
                                </div>
                            </div>
                            
                            <!-- 商品3 -->
                            <div style="width: calc(50% - 5px); background: #fff; border-radius: 8px; overflow: hidden; box-shadow: 0 1px 3px rgba(0,0,0,0.05);">
                                <div style="height: 120px; background: #e0e0e0; display: flex; align-items: center; justify-content: center; color: #999; font-size: 12px;">保温杯图</div>
                                <div style="padding: 10px;">
                                    <div style="font-size: 13px; font-weight: bold; margin-bottom: 5px; height: 36px; overflow: hidden;">智能保温杯</div>
                                    <div style="color: var(--warning-color); font-weight: bold; font-size: 14px;">150 积分</div>
                                    <button class="m-btn" style="padding: 5px; margin-top: 5px; font-size: 12px;">立即兑换</button>
                                </div>
                            </div>
                        </div>

                    </div>
                    
                    <!-- 底部操作栏 -->
                    <div class="bottom-action-bar">
                        <div class="nav-icon-btn" style="color: var(--primary-color);">
                            <span>🏠</span>
                            <span>商城</span>
                        </div>
                        <div class="nav-icon-btn">
                            <span>👤</span>
                            <span>我的</span>
                        </div>
                    </div>
                </div>

                <div class="step-arrow">→</div>

                <!-- 场景5：填写订单 -->
                <div class="phone-mockup">
                    <div class="phone-notch"></div>
                    <div class="phone-header">确认订单</div>
                    <div class="phone-content">
                        <div class="m-card">
                            <h4 style="margin:0 0 15px 0;">收货人信息</h4>
                            <input type="text" class="m-input" placeholder="请输入姓名" value="张三">
                            <input type="tel" class="m-input" placeholder="请输入手机号" value="13800138000">
                            
                            <!-- 省市区选择 -->
                            <div style="position:relative; margin-bottom:10px;">
                                <input type="text" class="m-input" style="margin-bottom:0; background:#fff;" readonly value="北京市 朝阳区" placeholder="请选择省/市/区" onclick="alert('省市区选择器（演示）')">
                                <span style="position:absolute; right:10px; top:10px; color:#999; pointer-events:none;">▼</span>
                            </div>
                            
                            <textarea class="m-input" rows="2" placeholder="详细地址：街道门牌号">xx街道xx大厦B座1001</textarea>
                        </div>

                        <div class="m-card">
                            <h4 style="margin:0 0 10px 0;">商品信息</h4>
                            <div style="display:flex; gap:10px;">
                                <div style="width:60px; height:60px; background:#eee; border-radius:4px; flex-shrink:0;"></div>
                                <div>
                                    <div style="font-weight:bold; font-size:14px; margin-bottom:5px; line-height:1.4;">【尊享版】享乐派豪华礼包</div>
                                    <div style="color:#999; font-size:12px;">规格：默认 (特级茶叶+坚果礼盒+定制保温杯)</div>
                                    <div style="margin-top:5px; font-size:13px;">x 1</div>
                                </div>
                            </div>
                        </div>

                        <div class="m-card">
                            <h4 style="margin:0 0 10px 0;">备注信息</h4>
                            <textarea class="m-input" rows="2" placeholder="如有特殊要求请留言（选填）" style="margin-bottom:0;"></textarea>
                        </div>
                    </div>
                    <div style="padding:15px; background:#fff; border-top:1px solid #eee;">
                        <button class="m-btn">提交订单</button>
                    </div>
                </div>

                <div class="step-arrow">→</div>

                <!-- 场景5：成功页 -->
                <div class="phone-mockup">
                    <div class="phone-notch"></div>
                    <div class="phone-header">兑换结果</div>
                    <div class="phone-content" style="text-align:center; padding-top:40px;">
                        <div style="width:80px; height:80px; background:var(--success-color); border-radius:50%; margin:0 auto 15px; color:#fff; font-size:50px; line-height:80px; box-shadow:0 10px 20px rgba(39, 174, 96, 0.3);">✓</div>
                        <h2 style="margin:0 0 10px 0; font-size:20px;">兑换成功</h2>
                        <p style="color:#999; font-size:13px; margin-bottom:30px;">商家已收到您的订单，将尽快发货</p>
                        
                        <div style="display:flex; justify-content:center; gap:15px; margin-bottom:30px;">
                            <button class="btn btn-outline" style="border-radius:20px; padding:8px 25px;">查看订单</button>
                            <button class="btn btn-primary" style="border-radius:20px; padding:8px 25px;">返回首页</button>
                        </div>

                        <!-- 猜你喜欢 -->
                        <div style="text-align:left;">
                            <div style="text-align:center; margin-bottom:15px; color:var(--primary-color); font-weight:bold; position:relative;">
                                <span style="background:#f5f5f5; padding:0 10px; position:relative; z-index:1;">❤ 猜你喜欢</span>
                                <div style="position:absolute; top:50%; left:20%; right:20%; height:1px; background:#ddd; z-index:0;"></div>
                            </div>
                            <div style="display:flex; flex-wrap:wrap; gap:10px;">
                                <div style="width:calc(50% - 5px); background:#fff; border-radius:8px; overflow:hidden;">
                                    <div style="height:140px; background:#e0e0e0;"></div>
                                    <div style="padding:8px;">
                                        <div style="font-size:13px; margin-bottom:5px;">精选零食大礼包</div>
                                    </div>
                                </div>
                                <div style="width:calc(50% - 5px); background:#fff; border-radius:8px; overflow:hidden;">
                                    <div style="height:140px; background:#e0e0e0;"></div>
                                    <div style="padding:8px;">
                                        <div style="font-size:13px; margin-bottom:5px;">高端定制马克杯</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

    </div>

    <!-- 弹窗组件：批次详情 -->
    <div id="batchDetailModal" class="modal-overlay" onclick="closeModal('batchDetailModal', event)">
        <div class="modal">
            <div class="modal-header">
                <span>批次详情</span>
                <span style="cursor:pointer;" onclick="closeModal('batchDetailModal')">×</span>
            </div>
            <div class="modal-body">
                <div class="admin-card" style="box-shadow:none; padding:0; margin-bottom:15px;">
                    <h4 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">基本信息</h4>
                    <div style="font-size:14px; line-height:2; color:#333;">
                        <div><strong>批次名称：</strong> <span id="bd-batch-name">--</span></div>
                        <div><strong>当前状态：</strong> <span id="bd-status" style="font-weight:bold;">--</span></div>
                        <div><strong>绑定商品：</strong> <span id="bd-product">--</span></div>
                        <div><strong>生成时间：</strong> <span id="bd-create-time">--</span></div>
                        <div><strong>预计发货：</strong> <span id="bd-delivery-time">--</span></div>
                        <div style="margin-top:5px; border-top:1px dashed #eee; padding-top:5px;"><strong>备注信息：</strong> <span id="bd-remark" style="color:#666;">--</span></div>
                    </div>
                </div>
                
                <div class="admin-card" style="box-shadow:none; padding:0;">
                    <h4 style="margin-top:0; border-bottom:1px solid #eee; padding-bottom:10px;">数据统计</h4>
                    <div style="display:flex; flex-wrap:wrap; gap:10px; margin-top:10px;">
                        <div style="width:calc(50% - 5px); background:#f9f9f9; padding:10px; border-radius:4px; text-align:center;">
                            <div style="color:#666; font-size:12px;">总卡量</div>
                            <div style="font-size:20px; font-weight:bold; color:var(--primary-color);" id="bd-total-count">0</div>
                        </div>
                        <div style="width:calc(50% - 5px); background:#f9f9f9; padding:10px; border-radius:4px; text-align:center;">
                            <div style="color:#666; font-size:12px;">已激活</div>
                            <div style="font-size:20px; font-weight:bold; color:var(--success-color);" id="bd-activated-count">0</div>
                        </div>
                        <div style="width:calc(50% - 5px); background:#f9f9f9; padding:10px; border-radius:4px; text-align:center;">
                            <div style="color:#666; font-size:12px;">已使用</div>
                            <div style="font-size:20px; font-weight:bold; color:var(--warning-color);" id="bd-used-count">0</div>
                        </div>
                        <div style="width:calc(50% - 5px); background:#f9f9f9; padding:10px; border-radius:4px; text-align:center;">
                            <div style="color:#666; font-size:12px;">已作废</div>
                            <div style="font-size:20px; font-weight:bold; color:var(--danger-color);" id="bd-void-count">0</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('batchDetailModal')">关闭</button>
            </div>
        </div>
    </div>

    <!-- 弹窗组件：修改批次 -->
    <div id="editBatchModal" class="modal-overlay" onclick="closeModal('editBatchModal', event)">
        <div class="modal">
            <div class="modal-header">
                <span>修改批次信息</span>
                <span style="cursor:pointer;" onclick="closeModal('editBatchModal')">×</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="edit-target-btn-id">
                <div class="form-group">
                    <label>批次名称 <span style="color:red">*</span></label>
                    <input type="text" id="edit-batch-name" class="form-control">
                </div>
                <div class="form-group">
                    <label>预计发货时间</label>
                    <input type="text" id="edit-delivery-time" class="form-control" placeholder="如：2026年1月30日">
                </div>
                <div class="form-group">
                    <label>备注信息</label>
                    <textarea id="edit-remark" class="form-control" rows="4" style="width: 100%; resize: vertical;" placeholder="备注信息..."></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('editBatchModal')">取消</button>
                <button class="btn btn-primary" onclick="submitEditBatch()">保存修改</button>
            </div>
        </div>
    </div>

    <!-- 弹窗组件：新增/编辑分发商 -->
    <div id="editDistributorModal" class="modal-overlay" onclick="closeModal('editDistributorModal', event)">
        <div class="modal">
            <div class="modal-header">
                <span id="distributor-modal-title">新增分发商</span>
                <span style="cursor:pointer;" onclick="closeModal('editDistributorModal')">×</span>
            </div>
            <div class="modal-body">
                <input type="hidden" id="distributor-id">
                <div class="form-group">
                    <label>分发商名称 <span style="color:red">*</span></label>
                    <input type="text" id="distributor-name" class="form-control" placeholder="请输入公司或个人名称">
                </div>
                <div class="form-group">
                    <label>联系人 <span style="color:red">*</span></label>
                    <input type="text" id="distributor-contact" class="form-control" placeholder="请输入联系人姓名">
                </div>
                <div class="form-group">
                    <label>联系电话 <span style="color:red">*</span></label>
                    <input type="text" id="distributor-phone" class="form-control" placeholder="请输入手机号或座机">
                </div>
                <div class="form-group">
                    <label>联系地址</label>
                    <textarea id="distributor-address" class="form-control" rows="3" style="width: 100%; resize: vertical;" placeholder="请输入详细地址"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('editDistributorModal')">取消</button>
                <button class="btn btn-primary" onclick="saveDistributor()">保存</button>
            </div>
        </div>
    </div>

    <!-- 弹窗组件：新增制卡 -->
    <div id="createCardModal" class="modal-overlay" onclick="closeModal('createCardModal', event)">
        <div class="modal" style="width: 650px;">
            <div class="modal-header">
                <span>新增制卡任务</span>
                <span style="cursor:pointer;" onclick="closeModal('createCardModal')">×</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label>批次名称 <span style="color:red">*</span></label>
                    <input type="text" class="form-control" placeholder="例如：2023中秋企业采购_A批次">
                </div>
                
                <!-- 卡片类型选择 -->
                <div class="form-group">
                    <label>卡片类型</label>
                    <div style="margin-top:5px;">
                        <label style="font-weight:normal; margin-right:20px; cursor:pointer;">
                            <input type="radio" name="cardType" value="product" checked onclick="toggleCardType(this.value)"> 商品兑换卡
                        </label>
                        <label style="font-weight:normal; cursor:pointer;">
                            <input type="radio" name="cardType" value="points" onclick="toggleCardType(this.value)"> 积分礼品卡
                        </label>
                    </div>
                </div>

                <!-- 场景1：商品关联配置 (商品卡专用) -->
                <!-- 
                <div id="type-product-config" class="form-group">
                    <label id="product-config-label">绑定商品 <span style="color:red">*</span></label>
                    <div style="border: 1px solid #ddd; padding: 10px; border-radius: 4px; background: #f9f9f9;">
                        <div id="selected-products" style="margin-bottom: 10px;"></div>
                        
                        <div style="display: flex; gap: 5px;">
                            <select id="product-select" class="form-control" style="flex: 1;" onchange="updateAddBtn()">
                                <option value="">请选择商品添加...</option>
                                <option value="豪华月饼礼盒 (ID: 1001)">豪华月饼礼盒 (ID: 1001)</option>
                                <option value="坚果大礼包 (ID: 1002)">坚果大礼包 (ID: 1002)</option>
                                <option value="海鲜大礼包 (ID: 1003)">海鲜大礼包 (ID: 1003)</option>
                                <option value="经典黑胶唱片 (ID: 2001)">经典黑胶唱片 (ID: 2001)</option>
                                <option value="无线蓝牙耳机 (ID: 2002)">无线蓝牙耳机 (ID: 2002)</option>
                                <option value="智能保温杯 (ID: 2003)">智能保温杯 (ID: 2003)</option>
                            </select>
                            <button id="btn-add-product" class="btn btn-secondary btn-sm" style="width: auto;" onclick="addProduct()" disabled>添加</button>
                        </div>
                    </div>
                </div>
                -->

                <!-- 场景2：积分卡配置 -->
                <div id="type-points-config" class="form-group" style="display:none;">
                    <label>积分面额 <span style="color:red">*</span></label>
                    <div style="display:flex; align-items:center; gap:10px;">
                        <input type="number" id="card-points" class="form-control" placeholder="如 300" style="width:150px;">
                        <span style="color:#666;">积分 (1积分=1元)</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>关联分发商与结算折扣</label>
                    <div style="background: #f9f9f9; padding: 15px; border-radius: 4px; border: 1px solid #eee;">
                        <div style="display:flex; gap:15px; align-items:flex-start;">
                            <div style="width: 280px;">
                                <label style="font-size:12px; color:#666; margin-bottom:5px; display:block; font-weight:normal;">选择分发商</label>
                                <select class="form-control" style="width:100%;">
                                    <option value="">直营 (无分发商)</option>
                                    <option value="dist_a">分发商A</option>
                                    <option value="dist_b">分发商B</option>
                                </select>
                            </div>
                            <div style="width:140px;" id="discount-rate-group">
                                <label style="font-size:12px; color:#666; margin-bottom:5px; display:block; font-weight:normal;">本批次折扣率 (%)</label>
                                <div style="position:relative;">
                                    <input type="number" class="form-control" placeholder="如 70" value="70" style="padding-right: 25px;">
                                    <span style="position:absolute; right:10px; top:50%; transform:translateY(-50%); color:#999; font-size:12px;">%</span>
                                </div>
                            </div>
                        </div>
                        <div style="margin-top: 8px; font-size: 12px; color: #999; line-height: 1.4;" id="discount-rate-tip">
                            * 设置折扣率后，系统将按 <code>实际发货商品价值 × 折扣率</code> 自动计算应结算金额。
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>制卡数量 (张) <span style="color:red">*</span></label>
                    <input type="number" id="card-quantity" class="form-control" value="100" oninput="calcCardRange()">
                </div>
                <div class="form-group">
                    <label>卡号设置</label>
                    <div style="margin-top:5px;">
                        <label style="font-weight:normal; margin-right:20px; cursor:pointer;">
                            <input type="radio" name="cardNoMode" value="auto" checked onclick="toggleCardMode(this.value)"> 默认 (系统生成)
                        </label>
                        <label style="font-weight:normal; cursor:pointer;">
                            <input type="radio" name="cardNoMode" value="custom" onclick="toggleCardMode(this.value)"> 自定义号段
                        </label>
                    </div>
                    <div id="cardNoRangeBox" style="display:none; margin-top:10px; align-items:center; background:#f9f9f9; padding:10px; border-radius:4px;">
                        <span style="color:#666; font-size:13px; margin-right:10px;">起始号 NO.</span>
                        <input type="number" id="startCardNo" class="form-control" style="width:120px; display:inline-block;" placeholder="1" value="1" oninput="calcCardRange()">
                        <span style="margin:0 10px; color:#999;">至</span>
                        <span style="font-weight:bold;">NO. <span id="endCardNo">100</span></span>
                    </div>
                </div>
                <div id="time-setting-group" class="form-group">
                    <label>时间设置</label>
                    <div style="display:flex; gap:10px; flex-wrap:wrap; background:#f9f9f9; padding:10px; border-radius:4px;">
                        <div style="flex:1; min-width:130px;">
                            <label style="font-size:12px; color:#666; font-weight:normal; display:block; margin-bottom:5px;">兑换开始时间</label>
                            <input type="datetime-local" id="create-start-time" class="form-control" style="font-size:12px; width:100%; box-sizing:border-box;">
                        </div>
                        <div style="flex:1; min-width:130px;">
                            <label style="font-size:12px; color:#666; font-weight:normal; display:block; margin-bottom:5px;">预计发货时间 (文本描述)</label>
                            <input type="text" id="create-delivery-time" class="form-control" style="font-size:12px; width:100%; box-sizing:border-box;" placeholder="如：2026年1月30日">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <label>初始状态</label>
                    <div>
                        <input type="radio" name="status" checked id="s1"> <label for="s1" style="display:inline; font-weight:normal;">未激活 (推荐)</label>
                        <input type="radio" name="status" id="s2" style="margin-left:15px;"> <label for="s2" style="display:inline; font-weight:normal;">直接激活</label>
                    </div>
                </div>
                <div class="form-group">
                    <div style="margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                        <label style="font-weight: 500;">备注信息</label>
                        <span style="font-size: 12px; color: #999;">（仅内部可见，不展示给用户）</span>
                    </div>
                    <textarea id="create-remark" class="form-control" rows="4" style="width: 100%; resize: vertical; min-height: 80px; line-height: 1.6;" placeholder="在此输入备注信息，例如：2023中秋企业采购订单、大客户定制需求等（可选填）"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('createCardModal')">取消</button>
                <button class="btn btn-primary" onclick="submitCreateCard()">确认生成</button>
            </div>
        </div>
    </div>

    <!-- 弹窗组件：订单详情 -->
    <div id="orderDetailModal" class="modal-overlay" onclick="closeModal('orderDetailModal', event)">
        <div class="modal" style="width: 600px;">
            <div class="modal-header">
                <span>订单详情</span>
                <span style="cursor:pointer;" onclick="closeModal('orderDetailModal')">×</span>
            </div>
            <div class="modal-body">
                <!-- 基础信息 -->
                <div style="background:#f8f9fa; padding:15px; border-radius:4px; margin-bottom:20px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <span style="color:#666;">订单编号：</span>
                        <span style="font-weight:bold;">ORD-20231026-055</span>
                    </div>
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                        <span style="color:#666;">下单时间：</span>
                        <span>2023-10-26 14:30:22</span>
                    </div>
                    <div style="display:flex; justify-content:space-between;">
                        <span style="color:#666;">当前状态：</span>
                        <span class="tag p2">已发货</span>
                    </div>
                </div>

                <!-- 商品信息 -->
                <div class="form-group">
                    <label style="border-bottom:1px solid #eee; padding-bottom:5px; margin-bottom:10px;">商品信息</label>
                    <div style="display:flex; gap:10px; align-items:center;">
                        <div style="width:50px; height:50px; background:#eee; border-radius:4px;"></div>
                        <div>
                            <div style="font-weight:bold;">坚果大礼包</div>
                            <div style="color:#999; font-size:12px;">规格：默认 x 1</div>
                        </div>
                    </div>
                </div>

                <!-- 收货信息 -->
                <div class="form-group">
                    <label style="border-bottom:1px solid #eee; padding-bottom:5px; margin-bottom:10px;">收货信息</label>
                    <div style="font-size:13px; line-height:1.8;">
                        <div><span style="color:#666; width:70px; display:inline-block;">收货人：</span>李四</div>
                        <div><span style="color:#666; width:70px; display:inline-block;">联系电话：</span>13900000000</div>
                        <div><span style="color:#666; width:70px; display:inline-block;">收货地址：</span>上海市浦东新区张江高科园区xx路xx号</div>
                    </div>
                </div>

                <!-- 物流信息 -->
                <div class="form-group">
                    <label style="border-bottom:1px solid #eee; padding-bottom:5px; margin-bottom:10px;">物流跟踪</label>
                    <div style="background:#f0f7ff; padding:10px; border-radius:4px; border:1px solid #cce5ff;">
                        <div style="font-weight:bold; color:#0056b3; margin-bottom:5px;">顺丰速运: SF1234567890</div>
                        <div style="font-size:12px; color:#666;">
                            <div>2023-10-27 09:00:00 [上海市] 快件派送中...</div>
                            <div style="margin-top:5px;">2023-10-26 20:00:00 [上海市] 快件到达集散中心</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('orderDetailModal')">关闭</button>
            </div>
        </div>
    </div>

    <!-- 弹窗组件：激活确认 -->
    <div id="activateConfirmModal" class="modal-overlay" onclick="closeModal('activateConfirmModal', event)">
        <div class="modal" style="width: 400px;">
            <div class="modal-header">
                <span>激活确认</span>
                <span style="cursor:pointer;" onclick="closeModal('activateConfirmModal')">×</span>
            </div>
            <div class="modal-body">
                <div style="text-align: center; padding: 20px 0;">
                    <div style="font-size: 48px; color: var(--warning-color); margin-bottom: 15px;">⚠️</div>
                    <p style="font-size: 16px; font-weight: bold; margin-bottom: 10px;">确认激活该批次卡片吗？</p>
                    <p style="color: #666; font-size: 14px;">激活后卡片将可以被用户兑换使用。<br>此操作不可撤销。</p>
                </div>
            </div>
            <div class="modal-footer">
                <input type="hidden" id="activate-target-btn-id">
                <button class="btn btn-outline" onclick="closeModal('activateConfirmModal')">取消</button>
                <button class="btn btn-primary" onclick="confirmActivate()">确认激活</button>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>